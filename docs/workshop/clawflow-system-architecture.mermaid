graph LR
    subgraph UI ["ğŸ–¥ï¸  Renderer â€” React + Zustand"]
        direction TB
        Workshop["ğŸ› ï¸ Workshop\nChat Â· Artifacts Â· Panels"]
        Dashboard["ğŸ“‹ Dashboard\nKanban Â· Metrics"]
        TaskDetail["ğŸ” Task Detail\nAgent Log Â· Interventions"]
    end

    subgraph Bridge ["ğŸŒ‰  Preload Bridge"]
        IPC["window.api\nTyped IPC Surface"]
    end

    subgraph Main ["âš™ï¸  Main Process â€” Node.js"]
        direction TB
        PE["ğŸš€ PipelineEngine\nStage Orchestrator"]
        WE["ğŸ’¬ WorkshopEngine\nChat Sessions"]
        SDK["ğŸ¤– SDKManager\nClaude Agent SDK"]
        SkillLoader["ğŸ“š SkillLoader"]
        KE["ğŸ§  KnowledgeEngine\nFDRL Store"]
        GE["ğŸŒ¿ GitEngine\nWorktrees"]
        CB["ğŸ“Š ContextBudget\nHandoff Monitor"]
        UM["âš¡ UsageMonitor\nRate Limit Guard"]
    end

    subgraph Data ["ğŸ’¾  Persistence"]
        direction TB
        GlobalDB[("Global DB\n~/.clawflow/")]
        ProjectDB[("Project DB\nper-project")]
        SkillFiles["Skills\n~/.clawflow/skills/\ncore.md Â· extended.md"]
    end

    subgraph Claude ["â˜ï¸  Anthropic API"]
        Opus["claude-opus-4-6"]
        Sonnet["claude-sonnet-4-6"]
        Haiku["claude-haiku-4-5"]
    end

    UI <--> Bridge
    Bridge <--> Main

    PE --> SDK
    WE --> SDK
    PE --> GE
    PE --> CB
    PE --> UM
    PE --> ProjectDB

    SDK --> Opus
    SDK --> Sonnet
    SDK --> Haiku
    SDK --> SkillLoader
    SDK --> KE

    SkillLoader --> SkillFiles
    KE --> GlobalDB
    KE --> ProjectDB